<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ساعاتي — حاسبة الدوام اليومية</title>
<style>
:root{
  --bg:#0b1020;--card:#0e1528;--ink:#e5e7eb;--muted:#94a3b8;
  --line:#1f2b40;--ok:#16a34a;--warn:#ef4444;--accent:#60a5fa
}
.light{
  --bg:#f8fafc;--card:#ffffff;--ink:#0f172a;--muted:#475569;
  --line:#e2e8f0;--ok:#16a34a;--warn:#ef4444;--accent:#3b82f6
}
body{
  margin:0;background:var(--bg);color:var(--ink);
  font-family:system-ui,"Noto Naskh Arabic",Tahoma,sans-serif
}
.wrap{max-width:720px;margin:24px auto;padding:16px;}
.card{background:var(--card);border:1px solid var(--line);
  border-radius:16px;padding:16px;box-shadow:0 4px 18px rgba(0,0,0,.25);}
h1{margin:0 0 8px;font-size:20px}
p.small{color:var(--muted);margin:0 0 12px}

/* الشريط العلوي */
.topbar{
  position:sticky;top:0;z-index:20;background:#0c1426;
  border-bottom:1px solid #1f2b40;
}
.topbar .inner{
  max-width:1060px;margin:0 auto;padding:10px 12px;
  display:flex;gap:8px;align-items:center;
  flex-wrap:nowrap;overflow-x:auto;-webkit-overflow-scrolling:touch;
  scrollbar-width:none;
}
.topbar .inner::-webkit-scrollbar{display:none;}
.topbar .inner button{
  flex-shrink:0;white-space:nowrap;height:36px;
}
.brand{font-weight:800;flex-shrink:0;}
.spacer{flex:1}
.btn-sm{
  padding:6px 10px;border-radius:10px;border:1px solid #2a3a55;
  background:#0a1222;color:#e5e7eb;cursor:pointer;font-size:14px;
}
.light .btn-sm{background:#ffffff;color:#0f172a;border-color:#e2e8f0;}
#themeBtn{order:99;}

/* مدخلات */
label{display:block;color:var(--muted);font-size:13px;margin-bottom:4px}
input{width:100%;padding:10px;border-radius:12px;border:1px solid var(--line);
background:#0a1222;color:var(--ink)}
.light input{background:#ffffff;color:#0f172a;border-color:#e2e8f0}
input[type=time],input[type=date],input[type=number]{direction:ltr}

/* بطاقات القيم */
.kpis{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:10px;margin-top:12px}
.kcard{border:1px solid var(--line);background:#0a1222;border-radius:12px;padding:12px;text-align:center}
.light .kcard{background:#ffffff;color:#0f172a;border-color:#e2e8f0;}
.kcard h3{margin:0;color:var(--muted);font-size:13px}
.kcard .val{font-size:20px;font-weight:700;margin-top:4px}
.primary{background:linear-gradient(180deg,#16a34a,#15803d);border:none;color:#fff;cursor:pointer}
</style>
</head>
<body>

<!-- الشريط -->
<div class="topbar">
  <div class="inner">
    <div class="brand">⏱️ ساعاتي</div>
    <button id="navHome" class="btn-sm">الرئيسية</button>
    <button id="navDay" class="btn-sm">اليوم</button>
    <button id="navMonth" class="btn-sm">الشهري</button>
    <button id="navSettings" class="btn-sm">الإعدادات</button>
    <button id="navExport" class="btn-sm">تصدير</button>
    <button id="themeBtn" class="btn-sm">ثيم مريح 🌙</button>
  </div>
</div>

<div class="wrap">
  <div class="card" id="dayCard">
    <h1>الإدخال اليومي</h1>
    <p class="small">اختر التاريخ وأدخل البداية والنهاية والاستراحة. الحفظ تلقائي محليًا.</p>
    <label>تاريخ</label>
    <input type="date" id="dayDate">
    <label>بداية</label>
    <input type="time" id="dayStart">
    <label>نهاية</label>
    <input type="time" id="dayEnd">
    <label>استراحة (دقيقة)</label>
    <input type="number" id="dayBreak" value="30" min="0" step="5">
    <div class="kpis">
      <div class="kcard"><h3>صافي اليوم</h3><div class="val" id="dNet">0:00</div></div>
      <div class="kcard"><h3>إضافي اليوم</h3><div class="val" id="dOT">0:00</div></div>
      <div class="kcard"><h3>أساس اليوم (س)</h3><div class="val" id="dBase">8</div></div>
      <div class="kcard"><h3>حالة الحفظ</h3><div class="val" id="dSave">—</div></div>
    </div>
    <button id="saveDay" class="primary" style="width:100%;margin-top:12px">💾 حفظ اليوم</button>
  </div>
</div>

<script>
const themeBtn=document.getElementById("themeBtn");
themeBtn.onclick=()=>{
  document.body.classList.toggle("light");
  themeBtn.textContent=document.body.classList.contains("light")?"ثيم داكن 🌙":"ثيم مريح ☀️";
};

const dayDate=document.getElementById("dayDate");
const dayStart=document.getElementById("dayStart");
const dayEnd=document.getElementById("dayEnd");
const dayBreak=document.getElementById("dayBreak");
const dNet=document.getElementById("dNet");
const dOT=document.getElementById("dOT");
const dBase=document.getElementById("dBase");
const dSave=document.getElementById("dSave");
const saveDay=document.getElementById("saveDay");

dayDate.value=new Date().toISOString().slice(0,10);

function h2m(h){if(!h)return 0;const [HH,MM]=h.split(":").map(Number);return HH*60+(MM||0);}
function m2h(m){const hh=Math.floor(m/60),mm=Math.round(m%60);return `${hh}:${mm.toString().padStart(2,"0")}`;}

function computeDay(){
  const s=dayStart.value,e=dayEnd.value,br=parseInt(dayBreak.value||0);
  if(!s||!e){dNet.textContent="0:00";dOT.textContent="0:00";return;}
  let sm=h2m(s),em=h2m(e);if(em<sm)em+=1440;
  const base=8*60;const total=(em-sm)-br;const ot=Math.max(0,total-base);
  dNet.textContent=m2h(total);dOT.textContent=m2h(ot);
}

[dayStart,dayEnd,dayBreak].forEach(el=>el.addEventListener("input",computeDay));

saveDay.onclick=()=>{
  const payload={date:dayDate.value,start:dayStart.value,end:dayEnd.value,break:dayBreak.value};
  localStorage.setItem("day-"+dayDate.value,JSON.stringify(payload));
  dSave.textContent="تم الحفظ ✅";setTimeout(()=>dSave.textContent="—",2000);
};
</script>
</body>
</html>
